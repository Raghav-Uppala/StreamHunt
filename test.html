<!DOCTYPE html>
<html>
  <body>
    <div id="box">Hello, animate me!</div>
    <button onclick="hideBox()">Hide</button>
    <button onclick="showBox()">Hide</button>
    <style>
      #box {
        background: lightblue;
        padding: 20px;
        margin: 10px 0;
        opacity: 1;
        overflow: hidden;
        transition: height 0.5s ease, opacity 0.5s ease, padding 0.5s ease, margin 0.5s ease;
      }
    </style>

<script>
function hideBox() {
  const box = document.getElementById("box");

  // Measure natural height
  const height = box.scrollHeight;

  // Set height explicitly to trigger transition
  box.style.height = height + "px";

  // Trigger animation on next frame
  requestAnimationFrame(() => {
    box.style.height = "0px";
    box.style.opacity = "0";
    box.style.padding = "0px";
    box.style.margin = "0px";
  });

  // After transition, set display:none
  box.addEventListener("transitionend", function handler(e) {
    if (e.propertyName === "height") {
      box.style.display = "none";
      box.removeEventListener("transitionend", handler);
    }
  });
}
function showBox() {
  const box = document.getElementById("box");
  box.style.display = "block";

  // Reset padding/margin/height to 0 for starting point
  box.style.height = "0px";
  box.style.padding = "0px";
  box.style.margin = "0px";
  box.style.opacity = "0";

  const naturalHeight = box.scrollHeight;

  requestAnimationFrame(() => {
    box.style.height = naturalHeight + "px";
    box.style.padding = "20px"; // restore original padding
    box.style.margin = "10px 0"; // restore original margin
    box.style.opacity = "1";
  });
}
</script>
  </body>
</html>

