const firebaseConfig={apiKey:"AIzaSyD-utxFiefXRu9eQ41QaLukNlAErZZ6_xQ",authDomain:"streamhunt-cbafc.firebaseapp.com",projectId:"streamhunt-cbafc",storageBucket:"streamhunt-cbafc.firebasestorage.app",messagingSenderId:"486383628659",appId:"1:486383628659:web:77f145faadf1a8c1419506"};firebase.initializeApp(firebaseConfig);const db=firebase.firestore();window.addEventListener("load",()=>{firebase.auth().onAuthStateChanged(n=>{n?(setState("signedIn",!0),setState("user",n)):(setState("signedIn",!1),setState("user",null))})});function firebaseCreateUserCollection(n,e){return db.collection("users").doc(n).collection(e).doc("init").set({createdAt:firebase.firestore.FieldValue.serverTimestamp()})}function firebaseCollectionsOnSignup(n){return Promise.all([firebaseCreateUserCollection(n,"WatchList"),firebaseCreateUserCollection(n,"Movies"),firebaseCreateUserCollection(n,"Shows")])}async function firebaseAddToCollection(n,e,t){try{return await db.collection("users").doc(state.user.uid).collection(n).doc(t).set(e),["success",null]}catch(i){return["error",i]}}async function firebaseUpdateDocCollection(n,e,t){try{return await db.collection("users").doc(state.user.uid).collection(n).doc(t).update(e),["success",null]}catch(i){return["error",i]}}async function firebaseGetCollection(n){try{let e=await db.collection("users").doc(state.user.uid).collection(n).get();if(e.empty==!1)return["success",e];if(e.empty==!0)return["success","empty"]}catch(e){return["error",e]}}async function firebaseSignup(n,e){try{return["success",await firebase.auth().createUserWithEmailAndPassword(n,e)]}catch(t){return["error",t]}}async function firebaseSignOut(){try{return await firebase.auth().signOut(),["success",cred]}catch(n){return["error",n]}}async function firebaseLoginEP(n,e){try{return await firebase.auth().setPersistence(firebase.auth.Auth.Persistence.LOCAL),["success",await firebase.auth().signInWithEmailAndPassword(n,e)]}catch(t){return new Promise(function(i){i(["error",t])})}}async function firebaseChangePassword(n){try{return await(await firebase.auth().currentUser).updatePassword(n),["success","none"]}catch(e){return["error",e]}}const options={method:"GET",headers:{accept:"application/json",Authorization:"Bearer eyJhbGciOiJIUzI1NiJ9.eyJhdWQiOiJmYWZkNTU3ODE1YjM0YWFkNDM4MmJiMGQ3MTk5MjY5NCIsIm5iZiI6MTcxMjgyNjY0MC4yOTYsInN1YiI6IjY2MTdhOTEwNmI1ZmMyMDE2MzI4NTNjZiIsInNjb3BlcyI6WyJhcGlfcmVhZCJdLCJ2ZXJzaW9uIjoxfQ.d8iWgFOyoeYag8YdBFGxs_swLYc4PRovUCmMfTrREQM"}};async function getTopRatedMovies(){return console.log("h"),fetch("https://api.themoviedb.org/3/movie/top_rated?language=en-US&page=1",options).then(n=>n.json()).catch(n=>console.error(n))}async function getPopularMovies(){return fetch("https://api.themoviedb.org/3/movie/popular?language=en-US&page=1",options).then(n=>n.json()).catch(n=>console.error(n))}async function getMovieGenreIds(){return fetch("https://api.themoviedb.org/3/genre/movie/list",options).then(n=>n.json()).catch(n=>console.error(n))}async function getMovieById(n){return fetch("https://api.themoviedb.org/3/movie/"+n+"?append_to_response=videos",options).then(e=>e.json()).catch(e=>console.error(e))}async function getMovieByName(n){return fetch("https://api.themoviedb.org/3/search/movie?query="+n,options).then(e=>e.json()).catch(e=>console.error(e))}async function getSimilarMovies(n){return fetch("https://api.themoviedb.org/3/movie/"+n+"/similar?language=en-US&page=1",options).then(e=>e.json()).catch(e=>console.error(e))}async function getMovieWatchProviders(n){return fetch("https://api.themoviedb.org/3/movie/"+n+"/watch/providers",options).then(e=>e.json()).catch(e=>console.error(e))}async function getMovieImages(n){return fetch("https://api.themoviedb.org/3/movie/"+n+"/images?language=en",options).then(e=>e.json()).catch(e=>console.error(e))}async function getMovieContentRating(n){return fetch("https://api.themoviedb.org/3/movie/"+n+"/release_dates",options).then(e=>e.json()).catch(e=>console.error(e))}async function getMovieCredits(n){return fetch("https://api.themoviedb.org/3/movie/"+n+"/credits?language=en-US",options).then(e=>e.json()).catch(e=>console.error(e))}async function getTopRatedShows(){return fetch("https://api.themoviedb.org/3/tv/top_rated?language=en-US&page=1",options).then(n=>n.json()).catch(n=>console.error(n))}async function getPopularShows(){return fetch("https://api.themoviedb.org/3/tv/popular?language=en-US&page=1",options).then(n=>n.json()).catch(n=>console.error(n))}async function getShowById(n){return fetch("https://api.themoviedb.org/3/tv/"+n+"?append_to_response=videos",options).then(e=>e.json()).catch(e=>console.error(e))}async function getShowSeasonsById(n,e){let t=[];for(let i=1;i<=Math.ceil(e/20);i++){let s=20+(i-1)*20;i==Math.ceil(e/20)&&(s=e);let r="";for(let a=(i-1)*20;a<s;a++)a!=0&&(r+=","),r+="season/"+(a+1);t.push(fetch("https://api.themoviedb.org/3/tv/"+n+"?append_to_response="+r,options))}return Promise.all(t).then(i=>Promise.all(i.map(s=>s.json()))).then(i=>{let s=i[0];if(i.length>1)for(let r=1;r<i.length;r++)Object.entries(i[r]).map(a=>{a[0].split("/")[0]=="season"&&(s[a[0]]=a[1])});return s}).catch(i=>console.error(i))}async function getShowByName(n){return fetch("https://api.themoviedb.org/3/search/tv?query="+n,options).then(e=>e.json()).catch(e=>console.error(e))}async function getSimilarShows(n){return fetch("https://api.themoviedb.org/3/tv/"+n+"/similar?language=en-US&page=1",options).then(e=>e.json()).catch(e=>console.error(e))}async function getShowWatchProviders(n){return fetch("https://api.themoviedb.org/3/tv/"+n+"/watch/providers",options).then(e=>e.json()).catch(e=>console.error(e))}async function getShowImages(n){return fetch("https://api.themoviedb.org/3/tv/"+n+"/images?language=en",options).then(e=>e.json()).catch(e=>console.error(e))}async function getShowContentRating(n){return fetch("https://api.themoviedb.org/3/tv/"+n+"/content_ratings",options).then(e=>e.json()).catch(e=>console.error(e))}async function getShowCredits(n){return fetch("https://api.themoviedb.org/3/tv/"+n+"/aggregate_credits?language=en-US",options).then(e=>e.json()).catch(e=>console.error(e))}async function userGetMovies(){try{const[n,e]=await firebaseGetCollection("Movies");if(e=="empty")return setState("movies",{}),["error",null];{let t={};return e.forEach(i=>{t[i.id]=i.data()}),setState("movies",t),["success",t]}}catch(n){return["error",n]}}async function userUpdateMovie(n,e){try{const t=await firebaseUpdateDocCollection("Movies",{timeStamp:e},n);let i=state.movies;return i[n]={timeStamp:e},setState("movies",i),t}catch(t){return["error",t]}}async function userAddMovie(n){try{return await firebaseAddToCollection("Movies",{timeStamp:"0"},n)}catch(e){return["error",e]}}async function userGetShows(){try{const[n,e]=await firebaseGetCollection("Shows");if(e=="empty")return setState("shows",{}),["error",null];{let t={};return e.forEach(i=>{t[i.id]=i.data()}),setState("shows",t),["success",t]}}catch(n){return["error",n]}}async function userUpdateShow(n,e,t){try{const i=await firebaseUpdateDocCollection("Shows",{episode:e,season:t},n);let s=state.shows;return s[n]={episode:e,season:t},setState("shows",s),i}catch(i){return["error",i]}}async function userAddShow(n,e,t){try{return await firebaseAddToCollection("Shows",{episode:e,season:t},n)}catch(i){return["error",i]}}async function getPersonByID(n){try{return(await fetch("https://api.themoviedb.org/3/person/"+n+"?language=en-US&append_to_response=movie_credits,tv_credits",options)).json()}catch(e){return["error",e]}}async function getPeopleByName(n){try{return(await fetch("https://api.themoviedb.org/3/search/person?query="+n+"?language=en-US",options)).json()}catch(e){return["error",e]}}function findHash(){let n=window.location.hash,[e,t]=n.split("?"),i={};return n==0?(e="_index",{path:e,params:i}):(e.length==0&&(e="_index"),e[0]=="#"&&(e=e.substring(1)),t&&t.split("&").forEach(s=>{const[r,a]=s.split("=");i[r]=decodeURIComponent(a)}),{path:e,params:i})}let routes={_index:"home-page",search:"search-page",info:"info-page",watch:"watch-page",person:"person-page"};function findPage({path:n,params:e}){if(n in routes){let t=document.createElement(routes[n]);t&&Object.keys(e).length!=0&&(t.params=e);let i=document.querySelector("#app");i.innerHTML="",i.appendChild(t)}}window.addEventListener("hashchange",function(){findPage(findHash())}),window.addEventListener("DOMContentLoaded",function(){findPage(findHash())});function jumpToTimestamp(){player.seekTo(0,!0)}function setDarkTheme(n){n?document.documentElement.setAttribute("data-theme","dark"):document.documentElement.setAttribute("data-theme","light")}setDarkTheme(!0);let state={countryName:"United States",countryCode:"US",signedIn:!1,user:null,shows:null,movies:null};const stateListener=new EventTarget;function setState(n,e){state[n]=e,stateListener.dispatchEvent(new CustomEvent("update-"+n,{detail:{name:n,value:e},bubbles:!0,composed:!0}))}function getState(n){return state[n]}setState("signedIn",!1),setState("user",null),stateListener.addEventListener("update-user",()=>{userGetShows()}),stateListener.addEventListener("update-user",()=>{userGetMovies()});class CustomHeader extends HTMLElement{#t;#e;constructor(){super(),this.#t=this.attachShadow({mode:"open"}),this.#e="",this.render()}get query(){return this.#e}set query(e){this.#e=e,this.render()}search(e){let t="#search?q="+encodeURIComponent(e);window.location.hash=t}render(){setDarkTheme(!0);let e=document.createElement("div");e.id="container",e.style.display="flex";let t=document.createElement("div");t.className="searchBarCont";let i=document.createElement("button");i.innerHTML='<svg class="searchIconSvg" aria-labelledby="title desc" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 19.9 19.7"><title id="title">Search Icon</title><desc id="desc">A magnifying glass icon.</desc><g class="search-path" fill="none" stroke="#848F91"><path stroke-linecap="square" d="M18.5 18.3l-5.4-5.4"/><circle cx="8" cy="8" r="7"/></g></svg>',i.setAttribute("aria-pressed","false"),i.className="searchIcon",i.addEventListener("click",()=>{let l=i.getAttribute("aria-pressed");if(l=="false"){let p=function(g){(g.type=="blur"||g.type=="keydown"&&g.keyCode==27)&&(s.classList.remove("open"),i.setAttribute("aria-pressed","false"),s.removeEventListener("blur",p),s.removeEventListener("keydown",p))};var c=p;i.setAttribute("aria-pressed","true"),s.offsetWidth,requestAnimationFrame(()=>{s.classList.add("open")}),s.style.display="flex",s.focus(),s.addEventListener("blur",p),s.addEventListener("keydown",p)}else l=="true"&&(i.setAttribute("aria-pressed","false"),s.classList.remove("open"),s.addEventListener("transitionend",()=>{s.style.display="none"},{once:!0}))});let s=document.createElement("input");s.className="searchBar",s.value=this.#e,t.appendChild(s),s.addEventListener("keypress",l=>{l.key=="Enter"&&this.search(s.value)}),t.appendChild(i);let r=document.createElement("signup-form");r.setAttribute("popover","auto"),r.id="loginForm";let a=document.createElement("button");a.textContent="login",a.setAttribute("popovertarget","loginForm"),stateListener.addEventListener("update-signedIn",l=>{l.detail.value==!0?(a.textContent="logout",a.setAttribute("popovertarget",""),a.addEventListener("click",()=>{firebaseSignOut()},{once:!0})):l.detail.value==!1&&(a.textContent="Login",a.setAttribute("popovertarget","loginForm"))}),stateListener.addEventListener("update-user",()=>{userGetShows()});let d=document.createElement("div");d.textContent="StreamHunt",d.style.color="white";let h=document.createElement("div");h.className+="cont",h.appendChild(t),h.appendChild(a),h.appendChild(r);let m=document.createElement("div");m.className+="cont",m.appendChild(d),e.appendChild(m),e.appendChild(h),this.#t.innerHTML=`
      <style>
        .searchIcon {
          background-color:transparent;
          border:none;
          border-radius:10px;
          padding:10px;
          margin-top:10px;
          margin-right:10px;
          align-items:center;

          &:hover {
            background-color:var(--primary-100);
          }
        }

        .searchIcon:hover .search-path {
          stroke:var(--secondary-500);
        }

        .searchIconSvg {
          display: inline-block;
          width: 30px;
          height: 30px;

          & .search-path {
            stroke:white;
          }
        }
        .searchBar {
          height:20px;
          width: 0;
          opacity: 0;
          transform: scaleX(0);
          transform-origin: right;
          transition: all 0.3s ease;
          border:none;
          border-bottom: 1px solid #ccc;
          border-radius: 4px;
          padding: 4px 8px;
          background-color:transparent;
          color:var(--text-900);

          &:focus {
            outline:none;
          }
        }
        .searchBar.open {
          width: 200px;
          opacity: 1;
          transform: scaleX(1);
        }
        .searchBarCont {
          display:flex;
          align-items:center;
          flex-direction:row;
        }
        #container {
          display:flex;
          align-items:center;
          justify-content: space-between;
          height:50px;
        }
        .cont {
          display:flex;
          align-items:center;
          flex-direction:row;
        }
      </style>
      `,this.#t.appendChild(e)}}customElements.define("custom-header",CustomHeader);class InfoBox extends HTMLElement{#t;#e;constructor(){super(),this.#t=this.attachShadow({mode:"open"}),this.#e=[],this.render()}get data(){return this.#e}set data(e){this.#e=structuredClone(e),this.render()}yearFromDate(e){return e.split("-")[0]}render(){let e=document.createElement("div");e.className="infoBackground";let t="https://image.tmdb.org/t/p/w1920";this.#e.backdrop_path!=null?t+=this.#e.backdrop_path:this.#e.poster_path!=null&&(t+=this.#e.poster_path);let i=document.createElement("div");i.className="infoBoxContainer";let s=document.createElement("h1");s.id="title",s.className="title",this.#e.mediaType=="m"?s.textContent=this.#e.title:this.#e.mediaType=="s"&&(s.textContent=this.#e.name);let r=document.createElement("img");r.id="titleImg",r.className="titleImg",this.#e.mediaType=="m"?getMovieImages(this.#e.id).then(u=>{u.logos.length!=0&&(r.src="https://image.tmdb.org/t/p/w500"+u.logos[0].file_path,this.#t.querySelector("#title").replaceWith(r))}):this.#e.mediaType=="s"&&getShowImages(this.#e.id).then(u=>{u.logos.length!=0&&(r.src="https://image.tmdb.org/t/p/w500"+u.logos[0].file_path,this.#t.querySelector("#title").replaceWith(r))});let a="";if(this.#e.mediaType=="m")a=this.yearFromDate(this.#e.release_date);else if(this.#e.mediaType=="s"){let u="";this.#e.in_production==!1&&(u=this.yearFromDate(this.#e.last_air_date)),a=this.yearFromDate(this.#e.first_air_date)+" - "+u,this.yearFromDate(this.#e.first_air_date)==u&&(a=this.yearFromDate(this.#e.first_air_date))}let d=document.createElement("h4");d.className="tagline",d.textContent=this.#e.tagline;let h=document.createElement("div");if(h.style.display="flex",h.className="genres",this.#e.genres!=null&&this.#e.genres!=null)for(let u=0;u<this.#e.genres.length;u++){let v=this.#e.genres[u].name,y=document.createElement("div");y.textContent=v,y.className="genre",h.appendChild(y)}let m=document.createElement("div");m.textContent=a,m.className="genre";let l=document.createElement("div");l.textContent=Math.round(this.#e.vote_average*10)/10,l.className="genre";let c=document.createElement("div");this.#e.original_language!=null&&(c.textContent=this.#e.original_language.toUpperCase()),c.className="genre";let p=document.createElement("div");if(p.style.display="none",this.#e.mediaType=="m"?getMovieContentRating(this.#e.id).then(u=>{let v=u.results.find(y=>y.iso_3166_1=="US");if(v)for(let y=0;y<v.release_dates.length;y++)v.release_dates[y].certification!=""&&(p.textContent=v.release_dates[y].certification,p.style.display="block");else h.removeChild(p)}):this.#e.mediaType=="s"&&getShowContentRating(this.#e.id).then(u=>{let v=u.results.find(y=>y.iso_3166_1=="US").rating;v!=null?p.textContent=v:h.removeChild(p)}),p.className="genre",m.textContent!=""&&h.appendChild(m),l.textContent!=""&&h.appendChild(l),this.#e.mediaType=="m"){let u=document.createElement("div");u.textContent=Math.floor(this.#e.runtime/60)+"h "+this.#e.runtime%60+"m",u.className="genre",u.textContent!=""&&h.appendChild(u)}h.appendChild(p),h.appendChild(c);let g=document.createElement("div"),f=document.createElement("div");f.className="desc",f.textContent=this.#e.overview;let o=document.createElement("div");o.className="descCont",o.appendChild(h),o.appendChild(f),g.appendChild(o),g.style.display="flex";let w=document.createElement("div");w.className="watchNowCont";let b=document.createElement("button");b.className="watchNow",b.textContent="Watch Now";let x="";if(this.#e.mediaType=="s"){let u=1,v=1;state.shows!=null?this.#e.id in state.shows&&(u=state.shows[this.#e.id].season,v=state.shows[this.#e.id].episode):stateListener.addEventListener("update-shows",()=>{this.#e.id in state.shows&&(u=state.shows[this.#e.id].season,v=state.shows[this.#e.id].episode,x="&s="+u+"&e="+v,console.log(x),b.addEventListener("click",()=>{window.location.hash="watch?id="+this.#e.id+"&t="+this.#e.mediaType+x}))},{once:!0}),console.log(x),x="&s="+u+"&e="+v}b.addEventListener("click",()=>{window.location.hash="watch?id="+this.#e.id+"&t="+this.#e.mediaType+x}),w.appendChild(b);let q='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" style="width:30px;"><path fill="white" d="M9.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l160 160c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L109.2 288 416 288c17.7 0 32-14.3 32-32s-14.3-32-32-32l-306.7 0L214.6 118.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-160 160z"/></svg>',M=document.createElement("div");M.innerHTML=q,M.className="backArrowCont",M.addEventListener("click",()=>{window.location.hash="#"}),i.appendChild(M),i.appendChild(s),i.appendChild(g),i.appendChild(w);let U=document.createElement("div");U.style.position="relative";const S=document.createElement("div");S.style.width="100%",S.style.height="100%",S.style.pointerEvents="none";let k=document.createElement("div");k.className="bg bg2",k.style.visibility="hidden",k.appendChild(S);let A=document.createElement("div");A.className="overlay",A.style.visibility="visible";let R='<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><g stroke-width="0"></g><g stroke-linecap="round" stroke-linejoin="round"></g><g> <g clip-path="url(#clip0_15_174)"> <rect width="24" height="24"></rect> <path d="M3 16V8H6L11 4V20L6 16H3Z" stroke="#ffffff" stroke-linecap="round" stroke-linejoin="round"></path> <path d="M13 9C13 9 15 9.5 15 12C15 14.5 13 15 13 15" stroke="#ffffff" stroke-linecap="round" stroke-linejoin="round"></path> <path d="M15 7C15 7 18 7.83333 18 12C18 16.1667 15 17 15 17" stroke="#fffff" stroke-linecap="round" stroke-linejoin="round"></path> <path d="M17 5C17 5 21 6.16667 21 12C21 17.8333 17 19 17 19" stroke="#ffffff" stroke-linecap="round" stroke-linejoin="round"></path> </g> <defs> <clipPath id="clip0_15_174"> <rect width="24" height="24"></rect> </clipPath> </defs> </g></svg>',P='<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g stroke-linecap="round" stroke-linejoin="round"></g><g> <g clip-path="url(#clip0_15_183)"> <rect width="24" height="24"></rect> <path d="M3 16V8H6L11 4V20L6 16H3Z" stroke="#ffffff" stroke-linecap="round" stroke-linejoin="round"></path> <path d="M14.5 15L20.5 9" stroke="#ffffff" stroke-linecap="round" stroke-linejoin="round"></path> <path d="M14.5 9L20.5 15" stroke="#ffffff" stroke-linecap="round" stroke-linejoin="round"></path> </g> <defs> <clipPath id="clip0_15_183"> <rect width="24" height="24"></rect> </clipPath> </defs> </g></svg>',C=document.createElement("button");C.setAttribute("aria-muted","true"),C.innerHTML=P,C.className="muteButton",k.appendChild(C),e.className+=" bg",e.style.visibility="visible";let L=document.createElement("div");L.className="bgC",L.appendChild(k),L.appendChild(A),L.appendChild(e),L.appendChild(i);function O(){let u=e.style.visibility,v=k.style.visibility;e.style.visibility=v,k.style.visibility=u}function V(){e.style.visibility="visible",k.style.visibility="hidden"}this.#t.innerHTML=`
      <style>
        .muteButton {
          z-index:9999;
          cursor: pointer;
          transition: all 0.2s ease-in-out;
          text-transform: uppercase;
          letter-spacing: 0.5px;
          border-radius:50%;
          position:absolute;
          top:50px;
          right:50px;
          border:none;
          background-color:color-mix(in srgb, var(--primary-200) 60%, transparent);
          height:50px;
          width:50px;
        }
        .muteButton:hover {
          background-color:var(--secondary-500);
          transform: scale(1.05);
          box-shadow: 0 0 20px rgba(color-mix(var(--secondary-500)) 0.6);
        }
        .backArrowCont {
          position:fixed;
          top:0;
          height:30px;
          width:30px;
          padding-right:30px;
          cursor:pointer;
          margin-top:3vh;
        }
        .backArrow {
          background:var(--light-background-50);
          height: 3px;
          width: 30px;
          position: relative;
          margin-top:3vh;
          margin-left:1vw;
          cursor: pointer;
          transform:rotate(180deg);
          &:before,
          &:after {
            content: "";
            background: var(--light-background-50);
            position: absolute;
            height: 3px;
            width: 15px;
          }
        
          &:before {
            right: -3px;
            bottom: -4px;
            transform: rotate(-45deg);
          }
        
          &:after {
            right: -3px;
            top: -4px;
            transform: rotate(45deg);
          }
        }
        .details {
          display:flex;
          gap:1rem;
        }
        .titleImg {
          width:500px;
        }
        .tagline {
          font-style: italic;
        }
        .desc {
          width:40vw;
        }
        .watchNowCont {
          width:100%;
          display:flex;
          justify-content:left;
          margin-top:1vh;
        }
        .watchNow {
          background-color:var(--primary-800);
          border-radius:20px;
          padding:5px;
          margin-top:1vh;
          width:130px;
          height:40px;
          font-weight:600;
          cursor: pointer;
          transition: all 0.2s ease-in-out;
          text-transform: uppercase;
          letter-spacing: 0.5px;
          border:none;
        }
        .watchNow:hover {
          background-color:var(--secondary-500);
          transform: scale(1.05);
          box-shadow: 0 0 20px rgba(color-mix(var(--secondary-500)) 0.6);
        }
        
        .watchNow:active {
          transform: scale(0.98);
        }

        .genres {
          margin-top:4vh;
          display:flex;
          flex-wrap: wrap;
          gap:1vw;
        }
        .genre {
          flex: 0 0 auto;
          background-color:var(--primary-200);
          border-radius:30px;
          margin-bottom:1vh;
          padding:5px 15px;
        }

        .infoBoxContainer {
          position:absolute;
          bottom:0;
          color:var(--text-900);
          padding:2vh;
          margin-left:1vw;
          z-index:2000;
        }

        @media only screen and (max-width: 1200px) { 
          .infoBoxContainer {
            color:var(--text-900);
            padding:2vh;
            padding-top:20vh;
          }
          .desc {
            width:90vw;
          }
        }

        .infoBackground {
          background-color:var(--background-50);
          background:
            linear-gradient(to right, var(--background-50), color-mix(in srgb, var(--background) 0%, transparent)),
            /*linear-gradient(to top, color-mix(in srgb, var(--background-50) 80%, transparent), color-mix(in srgb, var(--background-50) 0%, transparent)),*/
            url(${t});
          background-blend-mode: multiply;
          background-size: cover;
          background-position: center;
          background-repeat: no-repeat;
          display:flex;
          flex-direction:column-reverse;
        }
        .overlay {
          background: linear-gradient(to top, var(--background-50), rgba(0,0,0,0));
          z-index:1000;
        }
        .bg, .overlay {
          position: absolute;
          top: 0;
          left: 0;
          width: 100%;
          height: 100%;
          margin:0;
          padding:0;
        }

        .bgC {
          width: 100dvw;
          height: 100dvh;
        }
        @media (min-device-width: 320px) and (max-device-width: 480px) {
          .infoBackground {
            background-color:var(--background-50);
            background:
              linear-gradient(to right, color-mix(in srgb, var(--background) 50%, transparent), color-mix(in srgb, var(--background) 50%, transparent)),
              url(${t});
            background-position:center top;
            background-blend-mode: multiply;
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            height:80vh;
            display:flex;
          }
          .titleImg {
            width:300px;
            margin-bottom:4vh;
          }
          .watchNowCont {
            width:100%;
            display:flex;
            justify-content:center;
            margin-top:1vh;
          }

        }
        @import url('https://fonts.googleapis.com/css?family=Inter:700|Inter:400');
      </style>
    `,this.#t.appendChild(L);let I="9WZllcEgWrM";this.#e.videos&&(I=this.#e.videos.results.find(u=>u.type=="Trailer").key);let N=!1;function j(){o.style.overflow="hidden";const u=o.offsetHeight;o.style.height=u+"px",o.style.transition="height 1s ease, opacity 1s ease, padding 1s ease, margin 1s ease",r.style.overflow="hidden";const v=r.offsetWidth,y=r.offsetHeight;r.style.width=v+"px",r.style.height=y+"px",r.style.transition="width 1s ease, height 1s ease",o.offsetHeight,r.offsetHeight,requestAnimationFrame(()=>{o.style.height="0px",o.style.opacity="0",o.style.paddingTop="0px",o.style.paddingBottom="0px",o.style.marginTop="0px",o.style.marginBottom="0px";const _=300,B=r.naturalHeight*(_/r.naturalWidth);r.style.width=_+"px",r.style.height=B+"px"}),o.addEventListener("transitionend",function _(B){B.propertyName==="height"&&(o.style.display="none",o.removeEventListener("transitionend",_),N=!0)})}function Y(){N=!1,o.style.display="block",o.style.overflow="hidden",o.style.height="0px",o.style.opacity="0",o.style.paddingTop="0px",o.style.paddingBottom="0px",o.style.marginTop="0px",o.style.marginBottom="0px",o.offsetHeight,r.offsetHeight,requestAnimationFrame(()=>{o.style.transition="height 1s ease, opacity 1s ease, padding 1s ease, margin 1s ease",o.style.height=o.scrollHeight+"px",o.style.opacity="1",o.style.paddingTop="",o.style.paddingBottom="",o.style.marginTop="",o.style.marginBottom="";const u=500,v=r.naturalHeight*(u/r.naturalWidth);r.style.transition="width 1s ease, height 1s ease",r.style.width=u+"px",r.style.height=v+"px"}),o.addEventListener("transitionend",function u(v){v.propertyName==="height"&&(o.style.height="",o.style.overflow="",o.removeEventListener("transitionend",u))})}let E;if(C.addEventListener("click",()=>{C.getAttribute("aria-muted")=="false"?(C.innerHTML=P,E&&E.mute(),C.setAttribute("aria-muted","true")):C.getAttribute("aria-muted")=="true"&&(C.innerHTML=R,E&&E.unMute(),C.setAttribute("aria-muted","false"))}),window.YT)z();else{const u=document.createElement("script");u.src="https://www.youtube.com/iframe_api",document.head.appendChild(u),window.onYouTubeIframeAPIReady=()=>z()}let H,D,T;function W(){N==!1&&(clearTimeout(T),T=setTimeout(j(),1500))}function F(){N==!0&&(clearTimeout(T),T=setTimeout(Y(),1500))}function z(){E=new YT.Player(S,{videoId:I,playerVars:{autoplay:1,controls:0,mute:1,disablekb:1,fs:0,modestbranding:1,rel:0,iv_load_policy:3,cc_load_policy:0,playsinline:1,showinfo:0,enablejsapi:1},events:{onReady:()=>{console.log("onready"),H=setTimeout(()=>{E.setPlaybackQuality("highres"),E.seekTo(0),O(),D=setTimeout(()=>{j(),i.addEventListener("mouseenter",F),i.addEventListener("mouseleave",W)},1e3)},4e3);const u=setInterval(()=>{const v=E.getCurrentTime();E.getDuration()-v<=8&&(E.seekTo(0),E.playVideo())},400)},onError:()=>{console.log("onError"),clearTimeout(H),clearTimeout(D),clearTimeout(T),i.removeEventListener("mouseenter",F),i.removeEventListener("mouseleave",W),V(),o.style.height=o.scrollHeight+"px",o.style.opacity="1",o.style.paddingTop="",o.style.paddingBottom="",o.style.marginTop="",o.style.marginBottom="";const u=500,v=r.naturalHeight*(u/r.naturalWidth);r.style.width=u+"px",r.style.height=v+"px"}}})}}}customElements.define("info-box",InfoBox);class CarouselSlider extends HTMLElement{#t;#e;constructor(){super(),this.#t=this.attachShadow({mode:"open"}),this.#e=[],this.render()}get data(){return this.#e}set data(e){this.#e=structuredClone(e),this.render()}render(){let e=document.createElement("div");e.className="carousel";let t={};for(let h=0;h<this.#e.length;h++){t=this.#e[h];let m="m";t.hasOwnProperty("first_air_date")&&(m="s");let l=document.createElement("div");l.className="carouselItem";let c=document.createElement("img");c.src="https://image.tmdb.org/t/p/w342/"+t.poster_path,t.poster_path==null&&(c.src="https://placehold.co/342x513/60656b/FFF?text=No+Poster");let p=t.id;c.addEventListener("click",()=>{window.location.hash="info?id="+p+"&t="+m}),l.appendChild(c),l.setAttribute("tabindex","0"),e.appendChild(l)}let i=document.createElement("div");i.className="leftButton";let s=document.createElement("div");s.className="leftArrow",i.appendChild(s),s.addEventListener("click",()=>{e.scrollBy({left:-window.innerWidth*.8,top:0,behavior:"smooth"})});let r=document.createElement("div");r.className="rightButton";let a=document.createElement("div");a.className="rightArrow",r.appendChild(a),a.addEventListener("click",()=>{e.scrollBy({left:window.innerWidth*.8,top:0,behavior:"smooth"})});let d=document.createElement("div");d.className="carouselCont",this.#t.innerHTML=`
      <style>
        .leftButton, .rightButton {
          width:300px;
          height:calc(185px*1.5);
          position:absolute;
          pointer-events: none;
          align-content: center;
          z-index:99999;
        }
        .leftButton {
          left:0;
        }
        .rightButton {
          right:0;
        }

        .leftArrow, .rightArrow {
          border: solid var(--secondary-500);
          width:50px;
          height:50px;
          cursor: pointer;
          pointer-events: auto;
        }
        .leftArrow {
          border-width: 0 10px 10px 0;
          margin-left:20px;
          transform: rotate(135deg);
          -webkit-transform: rotate(135deg);
        }
        .rightArrow {
          border-width: 10px 10px 0 0;
          margin-left:220px;
          transform: rotate(45deg);
          -webkit-transform: rotate(45deg);
        }
        .carouselCont {
          position:relative;
          cursor:pointer;
          display:flex;
        }
        .carouselCont img {
          width:185px;
          height:calc(185px*1.5);
          opacity:1;
          trasition:opacity 0.3s ease;
        }

        .carouselCont img:hover {
          opacity:0.5;
        }

        .carousel {
          wdith:100dvw;
          display:flex;
          flex-direction:row;
          gap:1rem;
          width:100dwv;
          overflow-x:scroll;
          scrollbar-width: none;
        }
      </style>
    `,d.appendChild(i),d.appendChild(e),d.appendChild(r),this.#t.appendChild(d)}}customElements.define("carousel-slider",CarouselSlider);class PlayerFrame extends HTMLElement{#t;#e;constructor(){super(),this.#e=[],this.#t=this.attachShadow({mode:"open"})}get data(){return this.#e}set data(e){this.#e=structuredClone(e),this.render()}connectedCallback(){this.render()}render(){let e=document.createElement("iframe");e.setAttribute("referrerpolicy","no-referrer");let t="";if(this.#e.p=="v"){let a="movie",d="",h="";this.#e.t=="m"?a="movie":(this.#e.t="s")&&(a="tv",d="/"+this.#e.s+"/"+this.#e.e),t="https://vidlink.pro/"+a+"/"+this.#e.id+d+"?"+h}else if(this.#e.p=="e")t="https://www.2embed.cc/",this.#e.t=="m"?t+="embed/"+this.#e.id:(this.#e.t="s")&&(t+="embedtv/"+this.#e.id+"&s="+this.#e.s+"&e="+this.#e.e);else if(this.#e.p=="a")t="https://player.autoembed.cc/embed/",this.#e.t=="m"?t+="movie/"+this.#e.id:this.#e.t=="s"&&(t+="tv/"+this.#e.id+"/"+this.#e.s+"/"+this.#e.e);else if(this.#e.p=="s")t="https://vidsrc-embed.ru/embed",this.#e.t=="m"?t+="/movie/"+this.#e.id:this.#e.t=="s"&&(t+="/tv/"+this.#e.id+"/"+this.#e.s+"-"+this.#e.e);else if(this.#e.p=="k"){let a="?";t="https://www.vidking.net/embed/",this.#e.t=="m"?t+="movie/"+this.#e.id+a:this.#e.t=="s"&&(t+="tv/"+this.#e.id+"/"+this.#e.s+"/"+this.#e.e)}else this.#e.p=="i"&&(t="https://vidsrc.icu/embed/",this.#e.t=="m"?t+="movie/"+this.#e.id:this.#e.t=="s"&&(t+="tv/"+this.#e.id+"/"+this.#e.s+"/"+this.#e.e));console.log(t),e.src=t,e.setAttribute("allowfullscreen",""),e.setAttribute("frameborder","0"),e.className="iframe";let i='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" style="width:30px;"><path fill="white" d="M9.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l160 160c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L109.2 288 416 288c17.7 0 32-14.3 32-32s-14.3-32-32-32l-306.7 0L214.6 118.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-160 160z"/></svg>',s=document.createElement("div");s.innerHTML=i,s.className="backArrowCont",s.addEventListener("click",()=>{window.location.hash=""}),this.#t.innerHTML=`
      <style>
        .iframe {
          width:100vw; 
          height:100vh;
        }
        .backArrowCont {
          height:30px;
          width:30px;
          position:absolute;
          padding-right:30px;
          cursor:pointer;
          margin-top:3vh;
        }
        .backArrow {
          background:var(--light-background-50);
          height: 3px;
          width: 30px;
          position: relative;
          margin-top:3vh;
          margin-left:1vw;
          cursor: pointer;
          transform:rotate(180deg);
          &:before,
          &:after {
            content: "";
            background: var(--light-background-50);
            position: absolute;
            height: 3px;
            width: 15px;
          }
        
          &:before {
            right: -3px;
            bottom: -4px;
            transform: rotate(-45deg);
          }
        
          &:after {
            right: -3px;
            top: -4px;
            transform: rotate(45deg);
          }
        }
      </style>
    `;let r=document.createElement("div");r.appendChild(e),this.#t.appendChild(r)}}customElements.define("player-frame",PlayerFrame);class ServerSelector extends HTMLElement{#t;constructor(){super(),this.#t=this.attachShadow({mode:"open"}),this._options=[],this._selected=null}set options(e){this._options=e,this.render()}get value(){return this._selected}render(){let e=document.createElement("div");e.className="serverSelectorCont",this._options.forEach((t,i)=>{const s=document.createElement("label"),r=document.createElement("input");r.type="radio",r.name="serverSelector",r.value=t.value,i===0&&(r.checked=!0,this._selected=t.value),r.addEventListener("change",a=>{this._selected=a.target.value,this.dispatchEvent(new CustomEvent("new-server",{detail:{value:this._selected},bubbles:!0,composed:!0}))}),s.appendChild(r),s.append(" "+t.label),e.appendChild(s)}),this.#t.innerHTML=`
      <style>
        label { 
          display: flex;
          cursor: pointer;
          align-items:center;
          justify-content:center;
          padding:0 10px;
          border-radius:50px;
        }
        input[type=radio] {
          appearance: none;
          position:absolute;
          width:0px;
          height:0px;
        }
        label:has(input[type=radio]:checked) {
          background-color:var(--background-200);
        }
        .serverSelectorCont {
          color:var(--text-950);
          display:flex;
        }
      </style>
    `,this.#t.appendChild(e)}}customElements.define("server-selector",ServerSelector);class ProgressBar extends HTMLElement{#t;constructor(){super(),this.#t=this.attachShadow({mode:"open"})}connectedCallback(){this.render()}render(){let e=document.createElement("div");e.className="chart",e.id="graph";let t={percent:this.getAttribute("data-percent")||25,size:this.getAttribute("data-size")||220,lineWidth:this.getAttribute("data-line")||15,rotate:this.getAttribute("data-rotate")||0},i=t.size/4,s=document.createElement("canvas"),r=document.createElement("span");r.textContent=Math.round(t.percent),typeof G_vmlCanvasManager<"u"&&G_vmlCanvasManager.initElement(s);let a=s.getContext("2d");s.width=s.height=t.size,e.appendChild(r),e.appendChild(s),a.translate(t.size/2,t.size/2),a.rotate((-1/2+t.rotate/180)*Math.PI);let d=(t.size-t.lineWidth)/2,h=function(c,p,g){g=Math.min(Math.max(0,g),1),a.beginPath(),a.arc(0,0,d,0,Math.PI*2*g,!1),a.strokeStyle=c,a.lineCap="round",a.lineWidth=p,a.stroke()},m=getComputedStyle(document.documentElement).getPropertyValue("--primary-100").trim(),l=getComputedStyle(document.documentElement).getPropertyValue("--secondary-200").trim();h(m,t.lineWidth,100/100),h(l,t.lineWidth,t.percent/100),this.#t.innerHTML=`
    <style>
      div {
        position:relative;
        background-color:black;
        padding:10px;
        border-radius:${t.size}px;
        width:${t.size}px;
        height:${t.size}px;
      }
      canvas {
        display: block;
        position:absolute;
        top:10px;
        left:10px;
      }
      span {
        color:var(--text-900);
        display:block;
        line-height:${t.size}px;
        text-align:center;
        width:${t.size}px;
        font-family:sans-serif;
        font-size:${i}px;
        font-weight:100;
      }
    </style>
    `,this.#t.appendChild(e)}}customElements.define("progress-bar",ProgressBar);class EpisodeSelector extends HTMLElement{#t;#e;#i;constructor(){super(),this.#t=this.attachShadow({mode:"open"}),this.#e=[],this.#i={season:1,episode:1},this.render()}set data(e){this.#e=structuredClone(e),this.render()}get data(){return this.#e}set episode(e){this.#i=structuredClone(e),this.render()}get episode(){return this.#e}showEpisodes(e,t,i){i.innerHTML="";let s=document.createElement("div"),r='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" class="backArrow"><path fill="white" d="M9.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l160 160c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L109.2 288 416 288c17.7 0 32-14.3 32-32s-14.3-32-32-32l-306.7 0L214.6 118.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-160 160z"/></svg>',a=document.createElement("div");a.className="text",a.textContent="Season "+t,s.className="backSeason",s.insertAdjacentHTML("beforeend",r),s.appendChild(a),s.addEventListener("click",()=>{this.showSeasons(e,i)}),s.tabIndex=0,i.appendChild(s),s.focus();for(let d=0;d<e[t].episode_count;d++){let h=document.createElement("div");h.tabIndex=0,h.className="selectorItem episode",h.textContent="Episode "+(d+1),Object.keys(e[t]).includes("episodes")&&(h.textContent+=": "+e[t].episodes[d].name),h.addEventListener("click",()=>{this.dispatchEvent(new CustomEvent("new-episode",{detail:{season:t,episode:d+1},bubbles:!0,composed:!0}))}),t==this.#i.season&&d+1==this.#i.episode&&(h.className+=" currentEpisode"),i.appendChild(h)}}showSeasons(e,t){t.innerHTML="";for(let i=0;i<Object.keys(e).length;i++){let s=document.createElement("div");s.tabIndex=0,s.textContent="Season "+(i+1),s.className="selectorItem season",s.id="season"+(i+1),s.insertAdjacentHTML("beforeend",'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" class="seasonArrow"><path fill="white" d="M9.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l160 160c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L109.2 288 416 288c17.7 0 32-14.3 32-32s-14.3-32-32-32l-306.7 0L214.6 118.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-160 160z"/></svg>'),s.addEventListener("click",()=>{this.showEpisodes(e,i+1,t)}),t.appendChild(s)}}closeSelector(e,t,i,s,r){e.composedPath()[0]!=t&&e.composedPath()[0]!=i&&(s.removeChild(t),document.removeEventListener("click",r))}render(){if(this.#e.length!=0){let e=document.createElement("button");e.className="nextEpisode",e.textContent="Next Episode";let t=document.createElement("div");t.className="container";let i=document.createElement("button");i.className="selectorButton",i.textContent="episode",i.setAttribute("aria-pressed","false"),i.addEventListener("click",()=>{const a=i.getAttribute("aria-pressed")=="true";if(i.setAttribute("aria-pressed",!a),a)a&&t.removeChild(s);else{t.appendChild(s),this.showEpisodes(r,this.#i.season,s),s.focus();const d=h=>{s.contains(h.relatedTarget)?s.focus():(t.removeChild(s),i.setAttribute("aria-pressed","false"))};s.addEventListener("focusout",d)}});let s=document.createElement("div");s.className="selector",s.tabIndex=-1;let r={};for(let a=0;a<this.#e.length;a++)this.#e[a].season_number!=0&&(r[this.#e[a].season_number]=this.#e[a]);e.addEventListener("click",()=>{let a=this.#i.episode,d=this.#i.season;r[this.#i.season].episode_count>this.#i.episode?(a=+this.#i.episode+1,d=this.#i.season):Object.keys(r).length>this.#i.season&&(a=1,d=+this.#i.season+1),this.dispatchEvent(new CustomEvent("new-episode",{detail:{season:d,episode:a},bubbles:!0,composed:!0}))}),this.#t.innerHTML=`
        <style>
          .container {
            position: relative;
            width:200px;
          }
          .selector {
            background-color:var(--background-50);
            color:var(--text-900);
            position: absolute;
            top:-300px;
            left:-120px;
            z-index:100000;
            height:300px;
            width:300px;
            overflow-y:scroll;

          }
          .backSeason, .selectorItem.season{
            display:flex;
            align-items:center;
            gap:0.5rem;
          }
          .backArrow {
            height:20px;
            width:20px;
          }
          .selectorItem, .backSeason {
            color:var(--text-900);
            margin:5px 5px 5px 10px;
            cursor:pointer;
            padding:5px 5px 5px 10px;
            &:hover {
              background-color:var(--secondary-300);
            }
          }
          .seasonArrow {
            margin-left:20px;
            height:20px;
            width:20px;
            transform:rotate(180deg);
            visibility:hidden;
          }
          .selectorItem.episode {
            margin-left:30px;
          }
          .selectorItem.season {
            display:flex;
            justify-content:space-between;
            &:hover .seasonArrow {
              visibility:visible;
            }
          }
          .currentEpisode {
            font-weight:bold;
          }
        </style>
      `,t.appendChild(i),this.#e.length!=0&&(this.#i.season!=Object.keys(r).length||this.#i.episode!=r[this.#i.season].episode_count)&&t.appendChild(e),this.#t.appendChild(t)}}}customElements.define("episode-selector",EpisodeSelector);class WatchProviders extends HTMLElement{#t;#e;constructor(){super(),this.#t=this.attachShadow({mode:"open"}),this.#e=["us",void 0,void 0],this.render()}connectedCallback(){this.render()}get data(){return this.#e}set data(e){this.#e=structuredClone(e),this.render()}perProviderType(e,t,i,s){if(e[t]!=null){let r=document.createElement("div"),a=document.createElement("h3"),d=document.createElement("div");d.className="providerCont",r.appendChild(a),r.appendChild(d),a.textContent=s;for(let h=0;h<e[t].length;h++){let m=e[t][h],l=document.createElement("img");l.className="provider",l.src="https://image.tmdb.org/t/p/w45/"+m.logo_path,l.title+=m.provider_name,d.appendChild(l)}i.appendChild(r)}}updateWatchProviders(e,t){let i=e.results[this.#e[0].toUpperCase()];this.perProviderType(i,"flatrate",t,"Stream"),this.perProviderType(i,"free",t,"Free"),this.perProviderType(i,"buy",t,"Buy"),this.perProviderType(i,"rent",t,"Rent")}render(){let e=document.createElement("div");this.#e[1]!=null&&this.#e[2]!=null&&(this.#e[2]=="m"?getMovieWatchProviders(this.#e[1]).then(t=>{this.updateWatchProviders(t,e)}):this.#e[2]=="s"&&getShowWatchProviders(this.#e[1]).then(t=>{this.updateWatchProviders(t,e)})),this.#t.innerHTML=`
    <style>
    div {
      color:white;
    }
    .provider {
      width:45px;
      height:45px;
    } 
    .providerCont {
      display:flex;
      gap:1rem;
      flex-wrap: wrap;
    }
    </style>
    `,this.#t.appendChild(e)}}customElements.define("watch-providers",WatchProviders);class CreditsList extends HTMLElement{#t;#e;constructor(){super(),this.#t=this.attachShadow({mode:"open"}),this.#e=[],this.render()}get data(){return this.#e}set data(e){this.#e=structuredClone(e),this.render()}render(){let e=document.createElement("div");e.className="creditsContainer";let t=0;if(Object.keys(this.#e).length!=0){if(this.#e.mediaType=="m"){let h=[this.#e.crew.find(l=>l.job=="Director"),this.#e.crew.find(l=>l.job=="Screenplay"),...this.#e.crew.filter(l=>l.job=="Writer")],m=[];for(let l=0;l<h.length;l++){let c=h[l];if(c==null)continue;if(m.includes(c.id)){let w=e.querySelector("#crew"+c.id);w.textContent+=", "+c.job;continue}m.push(c.id);let p=document.createElement("div");p.className="creditContainer";let g=document.createElement("img");g.className="creditImg";let f=document.createElement("p");f.textContent=c.name,f.className="text name";let o=document.createElement("p");this.#e.mediaType=="m"?(o.textContent=c.job,o.id="crew"+c.id,o.className="text"):(o.textContent=c.jobs[0].job,o.id="crew"+c.id,o.className="text"),g.src="https://image.tmdb.org/t/p/h632/"+c.profile_path,(c.profile_path==null||c.profile_path==null)&&(g.src="https://placehold.co/182x278/60656b/FFF?text=No+Poster"),p.addEventListener("click",()=>{window.location.hash="person?id="+c.id}),p.appendChild(g),p.appendChild(f),p.appendChild(o),e.appendChild(p),t++}}for(let h=0;h<=5;h++){let m=this.#e.cast[h];if(m==null)continue;let l=document.createElement("div");l.className="creditContainer";let c=document.createElement("img");c.className="creditImg";let p=document.createElement("p");p.textContent=m.name,p.className="text name";let g=document.createElement("p");g.className="text",this.#e.mediaType=="m"?g.textContent=m.character:(g.textContent=m.roles[0].character,m.roles.length>1&&(g.textContent+=", "+m.roles[1].character),m.roles.length>2&&(g.textContent+=" and "+(m.roles.length-2)+" more...")),c.src="https://image.tmdb.org/t/p/h632/"+m.profile_path,(m.profile_path==null||m.profile_path==null)&&(c.src="https://placehold.co/182x278/60656b/FFF?text=No+Poster"),l.addEventListener("click",()=>{window.location.hash="person?id="+m.id}),l.appendChild(c),l.appendChild(p),l.appendChild(g),e.appendChild(l),l.addEventListener("click",()=>{e.scrollBy({left:-window.innerWidth*.8,top:0,behavior:"smooth"})}),t++}}let i=document.createElement("div");i.className="leftButton";let s=document.createElement("div");s.className="leftArrow",i.appendChild(s),s.addEventListener("click",()=>{e.scrollBy({left:-window.innerWidth*.8,top:0,behavior:"smooth"})});let r=document.createElement("div");r.className="rightButton";let a=document.createElement("div");a.className="rightArrow",r.appendChild(a),a.addEventListener("click",()=>{e.scrollBy({left:window.innerWidth*.8,top:0,behavior:"smooth"})});let d=document.createElement("div");d.className="finalCont",window.innerWidth<t*200?(d.appendChild(i),d.appendChild(e),d.appendChild(r)):d.appendChild(e),this.#t.innerHTML=`
      <style>
        .finalCont {
          display:flex;
        }
        .creditsContainer {
          display:flex;
          gap:2rem;
          wdith:100dvw;
          flex-direction:row;
          width:100dwv;
          overflow-x:scroll;
          scrollbar-width: none;
        }
        .creditContainer {
          display: flex;
          flex: 0 0 auto;
          flex-direction: column;
          width:185px;
          color:var(--text-900);
          background-color:var(--primary-100);
          border-radius:10px;
          cursor:pointer;
        }
        .creditContainer:hover {
          background-color:var(--secondary-100);
        }
        .creditImg {
          width:185px;
          height:276.4px;
          border-radius:10px 10px 0px 0px;
          height:auto;
        }
        .name {
          font-weight:bold;
        }
        .text {
          padding:5px;
          overflow-wrap: anywhere;
          word-break: break-word;
          white-space: normal;
          max-width: 100%;
          margin: 0;
        }
        .leftButton, .rightButton {
          width:300px;
          height:513px;
          position:absolute;
          pointer-events: none;
        }
        .leftButton {
          left:0;
        }
        .rightButton {
          right:0;
        }

        .leftArrow, .rightArrow {
          border: solid var(--secondary-500);
          width:50px;
          height:50px;
          display: inline-block;
          margin-top:185px;
          cursor: pointer;
          pointer-events: auto;
        }
        .leftArrow {
          border-width: 0 10px 10px 0;
          margin-left:20px;
          transform: rotate(135deg);
          -webkit-transform: rotate(135deg);
        }
        .rightArrow {
          border-width: 10px 10px 0 0;
          margin-left:220px;
          transform: rotate(45deg);
          -webkit-transform: rotate(45deg);
        }
      </style>
    `,this.#t.appendChild(d)}}customElements.define("credits-list",CreditsList);class SignupForm extends HTMLElement{#t;#e;constructor(){super(),this.#t=this.attachShadow({mode:"open"}),this.#e=[],this.render()}set data(e){this.#e=structuredClone(e),this.render()}get data(){return this.#e}render(){let e=document.createElement("div");e.className="formContainer";let t=document.createElement("form");t.className="form";let i=document.createElement("label");i.textContent="email";let s=document.createElement("input");s.name="username",s.autocomplete="username",s.id="email";let r=document.createElement("label");r.textContent="password";let a=document.createElement("input");a.name="password",a.autocomplete="password",a.setAttribute("type","password"),a.id="password";let d=document.createElement("button");d.textContent="Login",d.id="login";let h=document.createElement("button");h.textContent="Signup",h.id="signup",t.addEventListener("submit",f=>{f.preventDefault();let o=f.target.querySelector("#email").value,w=f.target.querySelector("#password").value;f.submitter.id=="login"?firebaseLoginEP(o,w).then(b=>{console.log(b)}):f.submitter.id=="signup"&&firebaseSignup(o,w).then(b=>{console.log(b)})}),t.appendChild(i),t.appendChild(s),t.appendChild(r),t.appendChild(a),t.appendChild(d),t.appendChild(h),e.appendChild(t);let m=document.createElement("div");m.className="formContainer";let l=document.createElement("form");l.className="form";let c=document.createElement("label");c.textContent="new password";let p=document.createElement("input");p.setAttribute("type","password"),p.id="newPassword";let g=document.createElement("button");g.textContent="change pass",g.id="login",l.addEventListener("submit",f=>{f.preventDefault();let o=f.target.querySelector("#newPassword").value;firebaseChangePassword(o).then(w=>{console.log(w)})}),l.appendChild(c),l.appendChild(p),l.appendChild(g),m.appendChild(l),this.#t.innerHTML=`
      <style>
        .form {
          display:flex;
          flex-direction:column;
        }
      </style>
    `,this.#t.appendChild(e),this.#t.appendChild(m)}}customElements.define("signup-form",SignupForm);class HomePage extends HTMLElement{#t;static cachedData=null;#e;constructor(){super(),this.#t=this.attachShadow({mode:"open"}),this.#e={}}connectedCallback(){HomePage.cachedData=JSON.parse(localStorage.getItem("homePageData")),HomePage.cachedData?this.render(HomePage.cachedData):this.fetchData()}fetchData(){let e=[getTopRatedMovies(),getTopRatedShows(),getPopularMovies(),getPopularShows()];Promise.all(e).then(t=>{HomePage.cachedData=t,localStorage.setItem("homePageData",JSON.stringify(t))}),this.render(e)}set params(e){this.#e=e,this.render()}get params(){return this.#e}getHeading(e){let t=document.createElement("div");t.className+="heading";let i=document.createElement("h1");i.textContent=e;let s=document.createElement("div");s.className="selector";let r=document.createElement("label"),a=document.createElement("input");a.type="radio",a.name=e+"Selector",a.value="movies",a.checked=!0,r.appendChild(a),r.append("Movies");let d=document.createElement("label"),h=document.createElement("input");return h.type="radio",h.name=e+"Selector",h.value="shows",d.appendChild(h),d.append("Shows"),s.appendChild(r),s.appendChild(d),t.appendChild(i),t.appendChild(s),[t,[h,a]]}render(e){fetch("https://ipapi.co/json/").then(o=>o.json()).then(o=>{state.countryName=o.country_name,state.countryCode=o.country});let t=document.createElement("div"),[i,s]=this.getHeading("Popular"),r=document.createElement("carousel-slider");r.id="popularMovies";let a=document.createElement("carousel-slider");a.id="popularShows",t.appendChild(i),t.appendChild(r),s.forEach(o=>o.addEventListener("change",w=>{w.target.value=="shows"?(t.removeChild(r),t.appendChild(a)):w.target.value=="movies"&&(t.removeChild(a),t.appendChild(r))}));let d=document.createElement("div"),[h,m]=this.getHeading("Top Rated"),l=document.createElement("carousel-slider");l.id="popularMovies";let c=document.createElement("carousel-slider");c.id="popularShows",d.appendChild(h),d.appendChild(l),m.forEach(o=>o.addEventListener("change",w=>{w.target.value=="shows"?(d.removeChild(l),d.appendChild(c)):w.target.value=="movies"&&(d.removeChild(c),d.appendChild(l))}));let p=document.createElement("carousel-slider");p.id="topRated";let g=document.createElement("h1");g.textContent="Top Rated";let f=document.createElement("div");f.className+="container",f.appendChild(document.createElement("custom-header")),f.appendChild(t),f.appendChild(d),this.#t.innerHTML=`
      <style>
        .heading {
          display:flex;
        }
        .container {
          margin:0px 1dvw;
        }
        h1 {
          color:var(--text-950);
        }
        .selector {
          display:flex;
          align-items:center;
          margin-left:10px;
        }
        label { 
          display: flex;
          cursor: pointer;
          align-items:center;
          justify-content:center;
          margin-left:10px;
          color:var(--text-700);
          height:30px;
        }
        input[type=radio] {
          appearance: none;
          position:absolute;
          width:0px;
          height:0px;
        }
        label:has(input[type=radio]:checked) {
          color:var(--text-950);
          margin-bottom:-3px;
          border-bottom:solid red 3px;
        }
      </style>
    `,this.#t.appendChild(f),Promise.resolve(e[0]).then(o=>{l.data=o.results}),Promise.resolve(e[1]).then(o=>{c.data=o.results}),Promise.resolve(e[2]).then(o=>{r.data=o.results}),Promise.resolve(e[3]).then(o=>{a.data=o.results})}}customElements.define("home-page",HomePage);class SearchPage extends HTMLElement{#t;#e;constructor(){super(),this.#t=this.attachShadow({mode:"open"}),this.#e={q:""},this.render()}get params(){return this.#e}set params(e){this.#e=structuredClone(e),this.render()}render(){this.#t.innerHTML=`
      <style>
        h1 {
          color:var(--text-950);
        }
      </style>
    `,console.log("hd",this.#e.q);let e=document.createElement("custom-header");if(e.query=this.#e.q,this.#t.appendChild(e),this.#e.q!=""){let t=document.createElement("carousel-slider"),i=document.createElement("h1");i.textContent="Movies";let s=document.createElement("carousel-slider"),r=document.createElement("h1");r.textContent="Shows";let a=document.createElement("carousel-slider"),d=document.createElement("h1");r.textContent="People",getMovieByName(this.#e.q).then(c=>{c.results.length==0?(this.#t.removeChild(i),this.#t.removeChild(t)):t.data=c.results}),getShowByName(this.#e.q).then(c=>{c.results.length==0?(this.#t.removeChild(r),this.#t.removeChild(s)):s.data=c.results}),getPeopleByName(this.#e.q).then(c=>{console.log(c),c.results.length==0?(this.#t.removeChild(d),this.#t.removeChild(a)):a.data=c.results}),this.#t.appendChild(i),this.#t.appendChild(t),this.#t.appendChild(r),this.#t.appendChild(s),this.#t.appendChild(d),this.#t.appendChild(a)}}}customElements.define("search-page",SearchPage);class InfoPage extends HTMLElement{#t;#e;constructor(){super(),this.#t=this.attachShadow({mode:"open"}),this.#e={id:null},this.render()}set params(e){this.#e=e,this.render()}get params(){return this.#e}render(){window.scrollTo(0,0);let e=document.createElement("info-box"),t=document.createElement("watch-providers"),i=document.createElement("div"),s=document.createElement("div");if(this.#e.id!=null){let r;this.#e.t=="m"?r=getMovieById(this.#e.id):this.#e.t=="s"&&(r=getShowById(this.#e.id)),r.then(l=>{l.mediaType=this.#e.t,e.data=l}),t.data=[state.countryCode,this.#e.id,this.#e.t];let a=document.createElement("h1");a.textContent="Similar ",a.className="heading";let d=document.createElement("carousel-slider");s.appendChild(a),s.appendChild(d),this.#e.t=="m"?(a.textContent+="Movies",getSimilarMovies(this.#e.id).then(l=>{d.data=l.results})):this.#e.t=="s"&&(a.textContent+="Shows",getSimilarShows(this.#e.id).then(l=>{d.data=l.results}));let h=document.createElement("h1");h.className="heading",h.textContent="Credits";let m=document.createElement("credits-list");this.#e.t=="m"?getMovieCredits(this.#e.id).then(l=>{let c=l;c.mediaType="m",m.data=l}):this.#e.t=="s"&&getShowCredits(this.#e.id).then(l=>{let c=l;c.mediaType="s",m.data=l}),i.appendChild(h),i.appendChild(m)}this.#t.innerHTML=`
      <style>
        body {
          background-color:var(--background-50);
        }
        .heading {
          color:var(--text-900);
        }
      </style>
    `,this.#t.appendChild(e),this.#t.appendChild(i),this.#t.appendChild(t),this.#t.appendChild(s)}}customElements.define("info-page",InfoPage);class WatchPage extends HTMLElement{#t;#e;constructor(){super(),this.#t=this.attachShadow({mode:"open"}),this.#e={p:"1",t:"m",id:"2",notLoaded:!1},this.render()}set params(e){this.#e=e,this.render()}get params(){return this.#e}render(){let e={1:"v",2:"k",3:"a",4:"s",5:"i"},t=document.createElement("player-frame"),i=structuredClone(this.#e);i.watchProgress=0,this.#e.p!=null?i.p=e[this.#e.p]:i.p="v",t.data=i;let s=document.createElement("server-selector");s.options=[{label:"Server 1",value:"1"},{label:"Server 2",value:"2"},{label:"Server 3",value:"3"},{label:"Server 4",value:"4"}],s.addEventListener("new-server",c=>{i.p=e[c.detail.value],t.data=i});let r=document.createElement("div");if(r.className="details",r.appendChild(s),this.#e.t=="s"){let c=document.createElement("episode-selector");c.episode={season:this.#e.s,episode:this.#e.e},getShowById(this.#e.id).then(p=>{c.data=p.seasons,getShowSeasonsById(this.#e.id,p.number_of_seasons).then(g=>{let f=[];for(let o=0;o<p.number_of_seasons;o++)f.push(g["season/"+(o+1)]),f[o].season_number=o+1,f[o].episode_count=f[o].episodes.length;c.data=f})}),c.addEventListener("new-episode",p=>{window.location.hash="#watch?id="+this.#e.id+"&t=s&s="+p.detail.season+"&e="+p.detail.episode,state.shows&&state.shows[this.#e.id]&&userUpdateShow(this.#e.id,p.detail.episode,p.detail.season*1).then(g=>console.log(g)),c.episode={season:p.detail.season*1,episode:p.detail.episode}}),r.appendChild(c)}let a=null;function d(c){a=setTimeout(async()=>{userAddShow(c.id,c.e,c.s)},1e4)}function h(c){a=setTimeout(async()=>{userAddMovie(c.id)},1e4)}function m(){a&&(clearTimeout(a),a=null)}state.shows&&!(this.#e.id in state.shows)&&this.#e.t=="s"&&!("notLoaded"in this.#e)&&this.#e.e!=1&&d(this.#e),state.movies&&this.#e.id in state.movies&&this.#e.t=="m"?"notLoaded"in this.#e||(i.watchProgress=state.movies[this.#e.id].timeStamp,console.log(state.movies[this.#e.id].timeStamp),t.data=i):state.movies&&!(this.#e.id in state.movies)&&this.#e.t=="m"&&("notLoaded"in this.#e||h(this.#e.id));let l=document.createElement("button");l.textContent="go back",l.addEventListener("click",()=>{window.location.hash="#info?id="+this.#e.id+"&t=s",m()}),this.#t.innerHTML=`
      <style>
        .details {
          display:flex;
          justify-content:space-between;
        }
      </style>
    `,this.#t.appendChild(t),this.#t.appendChild(r),this.#t.appendChild(l)}}customElements.define("watch-page",WatchPage);class PersonPage extends HTMLElement{#t;#e;constructor(){super(),this.#t=this.attachShadow({mode:"open"}),this.#e={}}set params(e){this.#e=e,this.render()}get params(){return this.#e}render(){let e=document.createElement("div");getPersonByID(this.#e.id).then(t=>{let i=document.createElement("h1");i.textContent=t.name,i.className+="text";let s=document.createElement("div");s.className="main";let r=document.createElement("div");r.className="content";let a=document.createElement("p");a.textContent=t.biography,a.className+="text",r.appendChild(a);let d=document.createElement("div");d.className="sidebar";let h=document.createElement("img");h.className="profilePic",h.src="https://image.tmdb.org/t/p/h632/"+t.profile_path;let m=document.createElement("p");m.textContent=t.birthday,m.className="text";let l=document.createElement("p");l.textContent=t.known_for_department,l.className="text";let c=document.createElement("p");c.textContent=t.place_of_birth,c.className="text";let p=document.createElement("p");p.textContent=Math.round(t.popularity*10)/10,p.className="text",d.appendChild(h),d.appendChild(l),d.appendChild(m),d.appendChild(c),d.appendChild(p),s.appendChild(d),s.appendChild(r);let g=document.createElement("carousel-slider"),f=document.createElement("h1");f.textContent="Movies",f.className="text";let o=[];t.movie_credits.cast.length!=0&&o.push(...t.movie_credits.cast),t.movie_credits.crew.length!=0&&o.push(...t.movie_credits.cast);let w=document.createElement("carousel-slider"),b=document.createElement("h1");b.textContent="Shows",b.className="text";let x=[];t.tv_credits.cast.length!=0&&x.push(...t.tv_credits.cast),t.tv_credits.crew.length!=0&&x.push(...t.tv_credits.crew),e.appendChild(i),e.appendChild(s),o.length!=0&&(g.data=o,e.appendChild(f),e.appendChild(g)),x.length!=0&&(w.data=x,e.appendChild(b),e.appendChild(w))}),this.#t.innerHTML=`
      <style>
        .text {
          color:var(--text-900);
        }
        .main {
          display:flex;
          gap:1em;
        }
        .profilePic {
          width:185px;
          height:276.4px;
          border-radius:10px 10px 0px 0px;
          height:auto;
        }
      </style>
    `,this.#t.appendChild(e)}}customElements.define("person-page",PersonPage);
